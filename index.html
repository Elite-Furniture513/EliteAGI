<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ELITE ‚Äî Retail Calculator (v4)</title>
  <link rel="stylesheet" href="styles.css"/>
  <script defer src="app.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">ELITE</div>
    <div class="top-actions">
      <label class="assoc">Associate
        <input id="associate" placeholder="Your name" autocomplete="name"/>
      </label>
      <button id="btnMode" class="btn ghost" title="Switch between Normal / Financing / Layaway">Change Mode</button>
      <button id="btnNew" class="btn ghost">New Quote</button>
      <button id="btnQuote" class="btn primary">Print Quote</button>
    </div>
  </header>

  <main class="container">
    <section class="crumbs" aria-label="Steps">
      <div class="crumb"><span class="n">1</span> Items</div>
      <div class="crumb"><span class="n">2</span> Delivery & Assembly</div>
      <div class="crumb" id="crumbMode"><span class="n">3</span> <span class="crumbModeText">Payment</span></div>
      <div class="crumb"><span class="n">4</span> Review</div>
    </section>

    <section class="mode-banner">
      <strong>Mode:</strong>
      <strong id="modeLabel">‚Äî</strong>
      <span class="muted" id="modeHint"></span>
    </section>

    <!-- STEP 1: ITEMS -->
    <section class="panel">
      <div class="panel-title-row">
        <h2 class="panel-title">Step 1 ‚Äî Items</h2>
        <div class="quick-add">
          <span class="muted">Quick add:</span>
          <button class="chip" data-template="Rug">Rug</button>
          <button class="chip" data-template="Living Room Set">Living Room Set</button>
          <button class="chip" data-template="Bedroom Set">Bedroom Set</button>
          <button class="chip" data-template="Dining Table">Dining Table</button>
          <button class="chip" data-template="Canopy Bed">Canopy Bed</button>
        </div>
        <div>
          <button id="btnAddRow" class="btn">Ôºã Add Item</button>
          <button id="btnClearRows" class="btn danger">‚úñ Clear</button>
        </div>
      </div>

      <div class="table-wrap">
        <table class="items">
          <thead>
            <tr><th>#</th><th>Qty</th><th>Description</th><th>Unit</th><th>Line</th><th></th></tr>
          </thead>
          <tbody id="itemsBody"></tbody>
        </table>
      </div>

      <div class="notes-wrap">
        <label>Description / Notes (shows on quote)
          <textarea id="notes" rows="3" placeholder="e.g., Color, size, model #, delivery instructions"></textarea>
        </label>
      </div>
    </section>

    <!-- STEP 2: DELIVERY & ASSEMBLY -->
    <section class="panel">
      <h2 class="panel-title">Step 2 ‚Äî Delivery & Assembly</h2>
      <div class="grid three">
        <label class="checkbox"><input id="includeDelivery" type="checkbox" checked/> Include Delivery ‚Äî <strong>$139 flat</strong></label>
        <div></div><div></div>
      </div>
      <div class="assembly-grid">
        <div class="assembly-item">
          <div>Dining Room Table</div>
          <div class="muted">$25 each</div>
          <div class="stepper"><button class="step minus" data-target="assmDining">‚àí</button><input type="number" id="assmDining" class="qty" min="0" step="1" value="0"/><button class="step plus" data-target="assmDining">+</button></div>
        </div>
        <div class="assembly-item">
          <div>Living Room Set</div>
          <div class="muted">$15 each</div>
          <div class="stepper"><button class="step minus" data-target="assmLiving">‚àí</button><input type="number" id="assmLiving" class="qty" min="0" step="1" value="0"/><button class="step plus" data-target="assmLiving">+</button></div>
        </div>
        <div class="assembly-item">
          <div>Bedroom Set</div>
          <div class="muted">$25 each</div>
          <div class="stepper"><button class="step minus" data-target="assmBedroom">‚àí</button><input type="number" id="assmBedroom" class="qty" min="0" step="1" value="0"/><button class="step plus" data-target="assmBedroom">+</button></div>
        </div>
        <div class="assembly-item">
          <div>Canopy Bed</div>
          <div class="muted">$150 each</div>
          <div class="stepper"><button class="step minus" data-target="assmCanopy">‚àí</button><input type="number" id="assmCanopy" class="qty" min="0" step="1" value="0"/><button class="step plus" data-target="assmCanopy">+</button></div>
        </div>
      </div>
      <p class="micro muted">Per Elite policy, **tax is only on merchandise** ‚Äî delivery & assembly are not taxed.</p>
    </section>

    <!-- STEP 3: MODE-SPECIFIC -->
    <section id="financingPanel" class="panel hide">
      <h2 class="panel-title">Step 3 ‚Äî Financing (Koalafi)</h2>
      <div class="grid three">
        <label>Customer Approved Amount
          <input id="approved" type="number" min="0" step="0.01" value="0"/>
        </label>
        <div class="info-block">
          <label class="checkbox"><input id="finDel" type="checkbox"/> Finance Delivery</label>
          <label class="checkbox"><input id="finAssm" type="checkbox"/> Finance Assembly</label>
          <div class="micro muted">Approval is applied in order: <strong>Items ‚Üí Delivery ‚Üí Assembly</strong>.</div>
        </div>
        <div class="info-block">
          <div>Financed: <strong id="financedTotal">$0.00</strong></div>
          <div class="micro muted" id="financeBreakdown">Items $0 ‚Ä¢ Delivery $0 ‚Ä¢ Assembly $0</div>
        </div>
      </div>
      <div class="grid three">
        <div class="info-block">
          <div>Cash portion (items): <strong id="cashItems">$0.00</strong></div>
          <div class="micro muted">Items not covered by approval</div>
        </div>
        <div class="info-block">
          <div>Cash due today: <strong id="cashDue">$0.00</strong></div>
          <div class="micro muted">Cash due = cash items + 8% tax on cash items + delivery not financed + assembly not financed</div>
        </div>
        <div class="info-block">
          <div>Approval remaining / short: <strong id="approvalStatus">$0.00</strong></div>
          <div class="micro muted">Positive = remaining; negative = short</div>
        </div>
      </div>
    </section>

    <section id="layawayPanel" class="panel hide">
      <h2 class="panel-title">Step 3 ‚Äî Layaway</h2>
      <div class="grid three">
        <div class="info-block">
          <div>10% down payment: <strong id="layawayDown">$0.00</strong></div>
          <div>Balance after down: <strong id="layawayBalance">$0.00</strong></div>
        </div>
      </div>
    </section>

    <!-- STEP 4: REVIEW -->
    <section class="panel totals">
      <h2 class="panel-title">Step 4 ‚Äî Review</h2>
      <div id="totalsExplain" class="micro muted"></div>
      <div class="totals-grid">
        <div class="row"><span>Subtotal (items)</span><strong id="subtotal">$0.00</strong></div>
        <div class="row"><span>Sales Tax (8% on items)</span><strong id="tax">$0.00</strong></div>
        <div class="row"><span>Delivery</span><strong id="delivery">$139.00</strong></div>
        <div class="row"><span>Assembly</span><strong id="assembly">$0.00</strong></div>
        <div class="row grand"><span id="grandLabel">Total</span><strong id="grandTotal">$0.00</strong></div>
      </div>
    </section>
  </main>

  <!-- Mode chooser modal (high-contrast, big targets, keyboard shortcuts) -->
  <div id="modeModal" class="backdrop visible" aria-hidden="false">
    <div class="modal modal-bright" role="dialog" aria-modal="true" aria-labelledby="modeTitle">
      <h3 id="modeTitle">Select how the customer is paying</h3>
      <p class="modal-sub">Press <strong>1</strong> = Normal ¬∑ <strong>2</strong> = Financing ¬∑ <strong>3</strong> = Layaway &nbsp;‚Ä¢&nbsp; <span class="muted">Enter to select ‚Ä¢ Esc to close</span></p>
      <div class="mode-cards">
        <button class="card big" data-mode="cash" role="button" tabindex="0" aria-label="Normal Payment (1)">
          <div class="card-icon">üíµ</div>
          <div class="card-title">Normal Payment</div>
          <div class="card-sub">8% tax + $139 delivery + assembly</div>
          <div class="kbd">1</div>
        </button>
        <button class="card big" data-mode="financing" role="button" tabindex="0" aria-label="Financing (2)">
          <div class="card-icon">üí≥</div>
          <div class="card-title">Financing (Koalafi)</div>
          <div class="card-sub">Use approval to finance items and (optionally) delivery & assembly.</div>
          <div class="kbd">2</div>
        </button>
        <button class="card big" data-mode="layaway" role="button" tabindex="0" aria-label="Layaway (3)">
          <div class="card-icon">üóìÔ∏è</div>
          <div class="card-title">Layaway</div>
          <div class="card-sub">10% down today, remainder later.</div>
          <div class="kbd">3</div>
        </button>
      </div>
    </div>
  </div>

  <!-- Sticky summary bar -->
  <div id="summaryBar" class="summary-bar" role="status" aria-live="polite">
    <div class="sum-left">
      <div class="sum-mode"><strong id="sumMode">‚Äî</strong></div>
      <div class="sum-hint muted" id="sumHint">‚Äî</div>
    </div>
    <div class="sum-right">
      <div class="sum-label" id="sumLabel">Total</div>
      <div class="sum-value" id="sumValue">$0.00</div>
      <button id="sumPrint" class="btn primary">Print Quote</button>
    </div>
  </div>

  <footer class="footer"><small>¬© ELITE ‚Äî Private store tool. Runs locally.</small></footer>
</body>
</html>
